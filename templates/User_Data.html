{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>User Data</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <!-- Font Awesome Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
  <!-- Custom CSS -->
  <link href="{% static 'User_Data.css' %}" rel="stylesheet"/>
</head>
<body>

  <!-- Vertical Navbar -->
  <div class="vertical-navbar">
    <div class="logo-section">
      <a href="/">
        <div class="ms-4 me-4">
          <img src="{% static 'logo2.jpg' %}" alt="Medical Logo" class="icon"/>
        </div>
        <h4>User Data</h4>
      </a>
    </div>
    <hr/>
    <ul class="nav flex-column" id="navbar">
      <li class="nav-item"><a class="nav-link" href="/"><i class="fas fa-home"></i> Home</a></li>
      <li class="nav-item"><a class="nav-link" href="/Dashboard/"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
      <li class="nav-item"><a class="nav-link" href="/Disease_Prediction/"><i class="fas fa-diagnoses"></i> Disease Prediction</a></li>
      <li class="nav-item"><a class="nav-link" href="/Report/"><i class="fas fa-file-alt"></i> Report Generation</a></li>
      <li class="nav-item"><a class="nav-link" href="/Blogs/"><i class="fas fa-blog"></i> Health Blogs</a></li>
      <hr/>
      <li class="nav-item"><a class="nav-link" href="/Profile_Management/"><i class="fas fa-user-circle"></i> Profile Management</a></li>
      <li class="nav-item"><a class="nav-link active" href="/User_Data/"><i class="fas fa-database"></i> User Data</a></li>
      <li class="nav-item"><a class="nav-link" href="/chatbot/"><i class="fas fa-comments"></i> Chatbot</a></li>
      <li class="nav-item"><a class="nav-link" href="/Logout/"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
    
    </ul>
  </div>

  <!-- Main Content -->
  <div class="content-container">
    <div class="container py-4">

      <!-- 1) User Info Card -->
      <div class="card user-info-card mb-4 shadow-sm">
        <div class="card-body d-flex align-items-center">
          <i class="fas fa-user-circle fa-3x me-3 text-primary"></i>
          <div>
            <h5 class="mb-1">{{ request.user.signupuser.full_name}}</h5>
            <p class="mb-0 text-muted">{{ request.user.email }}</p>
          </div>
        </div>
      </div>

      <!-- 2) Search by Diagnosis -->
      <form method="get" class="d-flex mb-4 search-form">
        <input
          type="text"
          name="q"
          value="{{ query }}"
          class="form-control me-2"
          placeholder="Search by diagnosisâ€¦"
        />
        <button type="submit" class="btn btn-primary search-btn">
          <i class="fas fa-search me-1"></i>Search
        </button>
      </form>

      <!-- 3) Export Button -->
      {% if user_reports %}
      <div class="d-flex justify-content-end mb-3">
        <a href="{% url 'export_user_data_pdf' %}" class="btn btn-danger">
          <i class="fas fa-file-pdf me-1"></i>Export as PDF
        </a>
      </div>
      {% endif %}

      <!-- 4) Prediction History Table -->
      {% if user_reports %}
        <div class="card shadow-sm">
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table table-striped table-hover mb-0">
                <thead class="table-dark text-center">
                  <tr>
                    <th>Date&Time</th>
                    <th>Symptoms</th>
                    <th>Diagnosis</th>
                    <th>Description</th>
                    <th>Precautions</th>
                    <th>Medications</th>
                    <th>Diet</th>
                    <th>Workout</th>
                  </tr>
                </thead>
                <tbody>
                  {% for report in user_reports %}
                  <tr>
                    <td>{{ report.created_at|date:"Y-m-d H:i" }}</td>
                    <td>{{ report.symptoms }}</td>
                    <td>{{ report.diagnosis }}</td>
                    <td>{{ report.description }}</td>
                    <td>{{ report.precautions }}</td>
                    <td>{{ report.medications }}</td>
                    <td>{{ report.diet }}</td>
                    <td>{{ report.workout }}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      {% else %}
        <div class="alert alert-info text-center">
          No matching records found.
        </div>
      {% endif %}

    </div>
  </div>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
